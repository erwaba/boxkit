FROM quay.io/fedora/fedora-toolbox:latest

LABEL com.github.containers.toolbox="true"

# Copy the setup scripts and package list
COPY ../scripts/scanners.sh /
COPY ../scripts/distrobox-shims.sh /
COPY ../packages/scanners.packages /

# Run the setup scripts
RUN chmod +x scanners.sh distrobox-shims.sh && /scanners.sh
RUN rm /scanners.sh /distrobox-shims.sh /scanners.packages

# create a .desktop file for gscan2pdf
# this printf syntax used because each RUN instruction is executed as a separate shell command
RUN mkdir -p /usr/share/applications && \
    printf '%s\n' \
    '[Desktop Entry]' \
    'Name=gscan2pdf' \
    'GenericName=PDF Scanner' \
    'Comment=Scan documents and create PDF files' \
    'Exec=gscan2pdf %F' \
    'Icon=gscan2pdf' \
    'Terminal=false' \
    'Type=Application' \
    'Categories=Graphics;Scanning;Office;' \
    'MimeType=image/png;image/jpeg;image/tiff;application/pdf;' \
    'StartupNotify=true' \
    > /usr/share/applications/gscan2pdf.desktop
