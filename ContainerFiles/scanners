FROM quay.io/fedora/fedora-toolbox:latest

LABEL com.github.containers.toolbox="true"

# Copy the setup scripts and package list
COPY ../scripts/scanners.sh /
COPY ../scripts/distrobox-shims.sh /
COPY ../packages/scanners.packages /

# Run the setup scripts
RUN chmod +x scanners.sh distrobox-shims.sh && /scanners.sh
RUN rm /scanners.sh /distrobox-shims.sh /scanners.packages

# create a .desktop file for gscan2pdf
RUN mkdir -p /usr/share/applications && \
    cat > /usr/share/applications/gscan2pdf.desktop << 'EOF'
[Desktop Entry]
Name=gscan2pdf
GenericName=PDF Scanner
Comment=Scan documents and create PDF files
Exec=gscan2pdf %F
Icon=gscan2pdf
Terminal=false
Type=Application
Categories=Graphics;Scanning;Office;
MimeType=image/png;image/jpeg;image/tiff;application/pdf;
StartupNotify=true
EOF

RUN chmod 644 /usr/share/applications/gscan2pdf.desktop && \
    update-desktop-database /usr/share/applications || true
